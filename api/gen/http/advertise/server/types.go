// Code generated by goa v3.15.2, DO NOT EDIT.
//
// advertise HTTP server types
//
// Command:
// $ goa gen github.com/Frank0945/go-advertise/api/design -o api

package server

import (
	"unicode/utf8"

	advertise "github.com/Frank0945/go-advertise/api/gen/advertise"
	goa "goa.design/goa/v3/pkg"
)

// CreateAdRequestBody is the type of the "advertise" service "create_ad"
// endpoint HTTP request body.
type CreateAdRequestBody struct {
	// Title of AD
	Title *string `form:"title,omitempty" json:"title,omitempty" xml:"title,omitempty"`
	// Start time of AD
	StartAt *string `form:"start_at,omitempty" json:"start_at,omitempty" xml:"start_at,omitempty"`
	// End time of AD
	EndAt      *string `form:"end_at,omitempty" json:"end_at,omitempty" xml:"end_at,omitempty"`
	Conditions *struct {
		// Start age of target
		AgeStart *int `form:"age_start" json:"age_start" xml:"age_start"`
		// End age of target
		AgeEnd *int `form:"age_end" json:"age_end" xml:"age_end"`
		// Gender of target
		Gender *string `form:"gender" json:"gender" xml:"gender"`
		// Country of target
		Country *string `form:"country" json:"country" xml:"country"`
		// Platform of target
		Platform *string `form:"platform" json:"platform" xml:"platform"`
	} `form:"conditions,omitempty" json:"conditions,omitempty" xml:"conditions,omitempty"`
}

// CreateAdResponseBody is the type of the "advertise" service "create_ad"
// endpoint HTTP response body.
type CreateAdResponseBody struct {
	// ID of the AD
	ID int `form:"id" json:"id" xml:"id"`
}

// ListAdsResponseBody is the type of the "advertise" service "list_ads"
// endpoint HTTP response body.
type ListAdsResponseBody []*AdResponse

// AdResponse is used to define fields on response body types.
type AdResponse struct {
	// Title of AD
	Title string `form:"title" json:"title" xml:"title"`
	// End time of AD
	EndAt string `form:"end_at" json:"end_at" xml:"end_at"`
}

// NewCreateAdResponseBody builds the HTTP response body from the result of the
// "create_ad" endpoint of the "advertise" service.
func NewCreateAdResponseBody(res *advertise.CreateAdResult) *CreateAdResponseBody {
	body := &CreateAdResponseBody{
		ID: res.ID,
	}
	return body
}

// NewListAdsResponseBody builds the HTTP response body from the result of the
// "list_ads" endpoint of the "advertise" service.
func NewListAdsResponseBody(res []*advertise.Ad) ListAdsResponseBody {
	body := make([]*AdResponse, len(res))
	for i, val := range res {
		body[i] = marshalAdvertiseAdToAdResponse(val)
	}
	return body
}

// NewCreateAdPayload builds a advertise service create_ad endpoint payload.
func NewCreateAdPayload(body *CreateAdRequestBody) *advertise.CreateAdPayload {
	v := &advertise.CreateAdPayload{
		Title:   *body.Title,
		StartAt: *body.StartAt,
		EndAt:   *body.EndAt,
	}
	if body.Conditions != nil {
		v.Conditions = &struct {
			// Start age of target
			AgeStart *int
			// End age of target
			AgeEnd *int
			// Gender of target
			Gender *string
			// Country of target
			Country *string
			// Platform of target
			Platform *string
		}{
			AgeStart: body.Conditions.AgeStart,
			AgeEnd:   body.Conditions.AgeEnd,
			Gender:   body.Conditions.Gender,
			Country:  body.Conditions.Country,
			Platform: body.Conditions.Platform,
		}
	}

	return v
}

// NewListAdsAdOverview builds a advertise service list_ads endpoint payload.
func NewListAdsAdOverview(offset int, limit int, ageStart *int, ageEnd *int, gender *string, country *string, platform *string) *advertise.AdOverview {
	v := &advertise.AdOverview{}
	v.Offset = offset
	v.Limit = limit
	v.AgeStart = ageStart
	v.AgeEnd = ageEnd
	v.Gender = gender
	v.Country = country
	v.Platform = platform

	return v
}

// ValidateCreateAdRequestBody runs the validations defined on
// create_ad_request_body
func ValidateCreateAdRequestBody(body *CreateAdRequestBody) (err error) {
	if body.Title == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("title", "body"))
	}
	if body.StartAt == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("start_at", "body"))
	}
	if body.EndAt == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("end_at", "body"))
	}
	if body.Title != nil {
		if utf8.RuneCountInString(*body.Title) < 1 {
			err = goa.MergeErrors(err, goa.InvalidLengthError("body.title", *body.Title, utf8.RuneCountInString(*body.Title), 1, true))
		}
	}
	if body.Title != nil {
		if utf8.RuneCountInString(*body.Title) > 100 {
			err = goa.MergeErrors(err, goa.InvalidLengthError("body.title", *body.Title, utf8.RuneCountInString(*body.Title), 100, false))
		}
	}
	if body.StartAt != nil {
		err = goa.MergeErrors(err, goa.ValidateFormat("body.start_at", *body.StartAt, goa.FormatDateTime))
	}
	if body.EndAt != nil {
		err = goa.MergeErrors(err, goa.ValidateFormat("body.end_at", *body.EndAt, goa.FormatDateTime))
	}
	if body.Conditions != nil {
		if body.Conditions.AgeStart != nil {
			if *body.Conditions.AgeStart < 1 {
				err = goa.MergeErrors(err, goa.InvalidRangeError("body.conditions.age_start", *body.Conditions.AgeStart, 1, true))
			}
		}
		if body.Conditions.AgeStart != nil {
			if *body.Conditions.AgeStart > 100 {
				err = goa.MergeErrors(err, goa.InvalidRangeError("body.conditions.age_start", *body.Conditions.AgeStart, 100, false))
			}
		}
		if body.Conditions.AgeEnd != nil {
			if *body.Conditions.AgeEnd < 1 {
				err = goa.MergeErrors(err, goa.InvalidRangeError("body.conditions.age_end", *body.Conditions.AgeEnd, 1, true))
			}
		}
		if body.Conditions.AgeEnd != nil {
			if *body.Conditions.AgeEnd > 100 {
				err = goa.MergeErrors(err, goa.InvalidRangeError("body.conditions.age_end", *body.Conditions.AgeEnd, 100, false))
			}
		}
		if body.Conditions.Gender != nil {
			if !(*body.Conditions.Gender == "M" || *body.Conditions.Gender == "F") {
				err = goa.MergeErrors(err, goa.InvalidEnumValueError("body.conditions.gender", *body.Conditions.Gender, []any{"M", "F"}))
			}
		}
		if body.Conditions.Country != nil {
			if !(*body.Conditions.Country == "TW" || *body.Conditions.Country == "JP") {
				err = goa.MergeErrors(err, goa.InvalidEnumValueError("body.conditions.country", *body.Conditions.Country, []any{"TW", "JP"}))
			}
		}
		if body.Conditions.Platform != nil {
			if !(*body.Conditions.Platform == "ios" || *body.Conditions.Platform == "android" || *body.Conditions.Platform == "web") {
				err = goa.MergeErrors(err, goa.InvalidEnumValueError("body.conditions.platform", *body.Conditions.Platform, []any{"ios", "android", "web"}))
			}
		}
	}
	return
}
